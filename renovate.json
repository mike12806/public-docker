{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "enabledManagers": [
    "docker-compose",
    "dockerfile",
    "helm-values",
    "kubernetes",
    "argocd",
    "github-actions",
    "regex"
  ],
  "automerge": true,
  "automergeType": "branch",
  "automergeStrategy": "auto",
  "platformAutomerge": true,
  "regexManagers": [
    {
      "fileMatch": ["^Dockerfiles/.+/Dockerfile$"],
      "matchStrings": [
        "ARG (?<depName>YQ|AWS_CLI|B2_CLI)_VERSION=(?<currentValue>[^\\s#]+)"
      ],
      "datasourceTemplate": "github-releases",
      "lookupNameTemplate": "{{#if depName == 'YQ'}}mikefarah/yq{{else if depName == 'AWS_CLI'}}aws/aws-cli{{else}}Backblaze/B2_Command_Line_Tool{{/if}}",
      "extractVersionTemplate": "^v?(?<version>.*)$"
    },
    {
      "fileMatch": ["^Dockerfiles/.+/Dockerfile$"],
      "matchStrings": [
        "ARG (?<depName>ANSIBLE|LINODE_CLI)_VERSION=(?<currentValue>[^\\s#]+)"
      ],
      "datasourceTemplate": "pypi",
      "lookupNameTemplate": "{{#if depName == 'ANSIBLE'}}ansible{{else}}linode-cli{{/if}}"
    },
    {
      "fileMatch": ["^Dockerfiles/.+/Dockerfile$"],
      "matchStrings": [
        "ARG (?<depName>PYTHON3_PIP|PYTHON3_VENV|PIPX|SSHPASS|JQ|RSYNC|OPENSSH_CLIENT|CURL|UNZIP|WGET)_VERSION=(?<currentValue>[^\\s#]+)"
      ],
      "datasourceTemplate": "repology",
      "depNameTemplate": "{{#if depName == 'PYTHON3_PIP'}}python3-pip{{else if depName == 'PYTHON3_VENV'}}python3-venv{{else if depName == 'PIPX'}}pipx{{else if depName == 'SSHPASS'}}sshpass{{else if depName == 'JQ'}}jq{{else if depName == 'RSYNC'}}rsync{{else if depName == 'OPENSSH_CLIENT'}}openssh-client{{else if depName == 'CURL'}}curl{{else if depName == 'UNZIP'}}unzip{{else}}wget{{/if}}"
    }
  ],
  "packageRules": [
    {
      "matchManagers": ["dockerfile"],
      "matchDepTypes": ["docker"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "matchManagers": ["dockerfile"],
      "matchDepTypes": ["docker"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true
    },
    {
      "matchDatasources": ["github-releases"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "matchDatasources": ["github-releases"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true
    },
    {
      "matchDatasources": ["pypi"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "matchDatasources": ["pypi"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true
    },
    {
      "matchDatasources": ["repology"],
      "automerge": true
    }
  ]
}
